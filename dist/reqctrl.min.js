!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.RequestControl=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){b.exports=function(){var a,b=arguments[0],c=arguments.length;for(a=1;c>a;a+=1)b=b.replace(/%s/,arguments[a]);return b}},{}],2:[function(a,b,c){(function(a){b.exports=function(b){var c,d={},e={},f=[],g=a.localStorage||{};return c=function(a,c){var h,i,a,j,k="string"==typeof a,l=typeof c,m="undefined"!==l&&"function"!==l;if("on"===g.lumberjack||b){if(!k||!m)throw Error("Lumberjack Error: log(channel, data) requires an channel {String} and a payload {String|Object|Number|Boolean}.");for(j={time:new Date,data:c,channel:a,id:f.length},d[a]=d[a]||[],d[a].push(j),f.push(j),e[a]=e[a]||[],i=e[a].length,h=0;i>h;h+=1)e[a][h](c)}},c.clear=function(a){a?d[a]=[]:(d={},f=[])},c.readback=function(a,b){var c="string"==typeof a;if(c)return b?JSON.stringify(d[a],null,4):d[a]||[];throw Error("log.readback(channel, pretty) requires an channel {String}.")},c.readback.master=function(a){return a?JSON.stringify(f,null,4):f},c.readback.channels=function(a){var b=Object.keys(d);return a?JSON.stringify(b):b},c.flush=function(a){var b;return a?(b=d[a],d[a]=[]):(d={},f=[],b=[]),b},c.on=function(a,b){var c="string"==typeof a,d="function"==typeof b;if(!c||!d)throw Error("log.on(channel, cb) requires an channel {String} and a callback {Function}.");e[a]=e[a]||[],e[a].push(b)},c.off=function(a){var b="string"==typeof a;if(!b)throw Error("log.off(channel) requires an channel {String}.");e[a]=[]},c.enable=function(){b=!0},c.disable=function(){b=!1},c}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(a,b,c){var d=a("./log.js"),e=a("./request-gate.js"),f=a("./marker.js");b.exports=function(a){function b(b){var e=new c(b),h=e.send;return e.send=function(){g.check()?(d("ajax",{msg:"request allowed",id:a.id}),h.apply(e,arguments)):f(a.id)},e}var c=a.context.XMLHttpRequest,g=e("AJAX",a);return b.rcSpy=!0,c.rcSpy?c:b}},{"./log.js":9,"./marker.js":10,"./request-gate.js":11}],4:[function(a,b,c){(function(c){var d=a("./log.js"),e=c.document.createElement("div"),f=a("./request-gate.js"),g=a("./marker.js");b.exports=function(a){function b(b){var f;return e.innerHTML="",c.call(e,b),f=e.innerHTML,f.indexOf("//")>=0?h.check()?(d("append",{msg:"request allowed",id:a.id,text:f}),c.call(this,b)):(g(a.id),b):(d("append",{msg:"non-request append allowed",id:a.id}),c.call(this,b))}var c=a.context.Element.prototype.appendChild,h=f("DomAppend",a);return b.rcSpy=!0,c.rcSpy?c:b}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./log.js":9,"./marker.js":10,"./request-gate.js":11}],5:[function(a,b,c){(function(c){var d,e=a("./ajax-spy.js"),f=a("./image-spy.js"),g=a("./append-spy.js"),h=a("./create-spy.js"),i=a("./request-gate.js"),j=a("./log.js");b.exports=function(a){function b(d,i){var k,l,m,n;for(d=d||c.self,c.top.rcDebug&&j.enable(),n={context:d,id:i||"top",grace:a.grace,throttle:a.throttle},(i||!i&&a.top)&&(d.XMLHttpRequest=e(n),d.Image=f(n),d.document.createElement=h(n),d.Element.prototype.appendChild=g(n)),m=d.frames.length,k=0;m>k;k+=1)try{l=d.frames[k],b(l,l.frameElement.id)}catch(o){}}return a=a||{},a.grace="grace"in a?a.grace:100,a.throttle="throttle"in a?a.throttle:800,a.top=a.top||!1,a.log=a.log||!1,a.throttle||i.disable(),a.log&&j.enable(),d||(b(),d=c.setInterval(b,500)),function(){c.clearInterval(d)}},b.exports.log=j}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./ajax-spy.js":3,"./append-spy.js":4,"./create-spy.js":6,"./image-spy.js":7,"./log.js":9,"./request-gate.js":11}],6:[function(a,b,c){var d=(a("./log.js"),a("./request-gate.js")),e=a("./marker.js"),f=a("./image.js");b.exports=function(a){function b(b){return"img"===b?g.check()?f(a.context,a.id):(e(a.id),c.call(a.context.document,"span")):c.call(a.context.document,b)}var c=a.context.document.createElement,g=d("Image",a);return b.rcSpy=!0,c.rcSpy?c:b}},{"./image.js":8,"./log.js":9,"./marker.js":10,"./request-gate.js":11}],7:[function(a,b,c){var d=(a("./log.js"),a("./request-gate.js")),e=a("./marker.js"),f=a("./image.js");b.exports=function(a){function b(b,c){return g.check()?f(a.context,a.id):(e(a.id),{})}var c=a.context.Image,g=d("Image",a);return b.rcSpy=!0,c.rcSpy?c:b}},{"./image.js":8,"./log.js":9,"./marker.js":10,"./request-gate.js":11}],8:[function(a,b,c){(function(c){function d(a,b){return f.call(b.document,a)}var e=a("./log.js"),f=c.document.createElement;b.exports=function(a,b){var f=d("span",a),g=d("img",a);return f.appendChild(g),c.Object.defineProperty(f,"src",{get:function(){return g.src},set:function(a){e("image",{msg:"Fetching image",src:a,id:b}),g.src=a}}),f}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./log.js":9}],9:[function(a,b,c){(function(c){var d=a("lumberjackjs"),e=d(),f={};b.exports=e,e.update=function(a,b,c){f[a]=f[a]||{},f[a][b]=c},e.report=function(a){var b,d,g,h;a=a||"",b=a.indexOf("image")>=0,d=a.indexOf("ajax")>=0,g=a.indexOf("append")>=0,h=a.indexOf("all")>=0,c.console.clear(),c.console.log("\n~~~~~~~~~~~~ SUMMARY ~~~~~~~~~~~~"),c.console.log(c.JSON.stringify(f,null,2)),c.console.log("\n"),(b||h)&&(c.console.log("\n~~~~~~~~~~~~ IMAGE ~~~~~~~~~~~~"),c.console.log(c.JSON.stringify(e.readback("image"),null,2)),c.console.log("\n")),(d||h)&&(c.console.log("\n~~~~~~~~~~~~ AJAX ~~~~~~~~~~~~"),c.console.log(c.JSON.stringify(e.readback("ajax"),null,2)),c.console.log("\n")),(g||h)&&(c.console.log("\n~~~~~~~~~~~~ APPEND ~~~~~~~~~~~~"),c.console.log(c.JSON.stringify(e.readback("append"),null,2)),c.console.log("\n"))}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{lumberjackjs:2}],10:[function(a,b,c){(function(a){var c={};b.exports=function(b){var d;a.top.rcDebug&&(b in c||(d=a.top.document.getElementById(b),d&&(d.style.border="4px solid red")),c[b]=!0)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],11:[function(a,b,c){(function(c){var d=a("./stat-set.js"),e=a("./log.js"),f=!1;b.exports=function(a,b){var g=b.context||c.self;return g.rcStats=g.rcStats||{},g.rcStats[a]=g.rcStats[a]||d(a,b.id),g.rcLast=g.rcLast||{},g.rcLast[a]=g.rcLast[a]||0,{check:function(){var d=c.Date.now(),h=!g.rcLast[a],i=d-g.rcLast[a]>b.throttle,j=this.stats.net.made<b.grace;return this.stats.count.attempted(),f||j||h||i?(this.close(),this.stats.count.made(),e("gate",{blocked:!1,type:a,id:b.id,made:this.stats.net.made,attempted:this.stats.net.attempted}),!0):(e("gate",{blocked:!0,type:a,id:b.id,made:this.stats.net.made,attempted:this.stats.net.attempted}),!1)},close:function(){g.rcLast[a]=c.Date.now()},open:function(){g.rcLast[a]=0},stats:g.rcStats[a]}},b.exports.disable=function(){f=!0}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./log.js":9,"./stat-set.js":13}],12:[function(a,b,c){(function(c){var d=a("curb");b.exports=function(){return{attempted:0,made:0,toString:function(){return d("(made/attempted) %s/%s %s%",this.made,this.attempted,this.attempted?c.Math.round(this.made/this.attempted*100):0)}}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{curb:1}],13:[function(a,b,c){(function(c){var d=a("./stat-node.js"),e=a("./log.js");b.exports=function(a,b){var f={rps:d(),net:d(),count:{made:function(){f.rps.made+=1,f.net.made+=1},attempted:function(){f.rps.attempted+=1,f.net.attempted+=1}}},g=0,h=0;return c.setInterval(function(){f.rps.made=f.net.made-g,f.rps.attempted=f.net.attempted-h,g=f.net.made,h=f.net.attempted,e.update(b,a,f.net.toString())},1e3),f}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./log.js":9,"./stat-node.js":12}]},{},[5])(5)});